<div class="min-h-screen bg-gray-50">
  <!-- Header -->
  <header class="bg-white shadow-sm">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
      <div class="flex items-center space-x-3">
        <button (click)="goBack()" class="text-gray-600 hover:text-gray-900">
          â† ZurÃ¼ck
        </button>
        <span class="text-3xl">ğŸ“Š</span>
        <h1 class="text-2xl font-bold text-gray-900">Wochenstatistiken</h1>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div *ngIf="loading" class="text-center py-12">
      <div class="text-4xl mb-4">â³</div>
      <p class="text-gray-600">Lade Statistiken...</p>
    </div>

    <div *ngIf="!loading">
      <!-- Wochen-Info -->
      <div class="mb-6 text-center">
        <p class="text-gray-600">Woche beginnend: <span class="font-semibold">{{ currentWeekStart }}</span></p>
      </div>

      <!-- Ãœbersichtsstatistiken -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <div class="card bg-gradient-to-br from-primary-50 to-primary-100 text-center">
          <div class="text-3xl mb-2">ğŸ™Œ</div>
          <div class="text-3xl font-bold text-primary-700">{{ getTotalGiven() }}</div>
          <div class="text-sm text-primary-600 font-medium">Gesamt High-Fives gegeben</div>
        </div>

        <div class="card bg-gradient-to-br from-success-50 to-success-100 text-center">
          <div class="text-3xl mb-2">ğŸ‰</div>
          <div class="text-3xl font-bold text-success-700">{{ getTotalReceived() }}</div>
          <div class="text-sm text-success-600 font-medium">Gesamt High-Fives erhalten</div>
        </div>

        <div class="card bg-gradient-to-br from-purple-50 to-purple-100 text-center">
          <div class="text-3xl mb-2">ğŸŒŸ</div>
          <div class="text-3xl font-bold text-purple-700">{{ getGoalAchievers() }}/{{ weeklyStats.length }}</div>
          <div class="text-sm text-purple-600 font-medium">Wochenziel erreicht</div>
        </div>
      </div>

      <!-- Benutzerstatistik-Tabelle -->
      <div class="card">
        <h2 class="text-xl font-bold text-gray-900 mb-4">Team-Bestenliste</h2>
        
        <div *ngIf="weeklyStats.length === 0" class="text-center py-8 text-gray-500">
          <div class="text-4xl mb-2">ğŸ“‹</div>
          <p>Noch keine Daten fÃ¼r diese Woche verfÃ¼gbar.</p>
        </div>

        <div *ngIf="weeklyStats.length > 0" class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Rang
                </th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Teammitglied
                </th>
                <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Gegeben
                </th>
                <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Erhalten
                </th>
                <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Status
                </th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              <tr *ngFor="let stat of weeklyStats; let i = index" 
                  [class.bg-yellow-50]="i === 0 && stat.received_count > 0"
                  class="hover:bg-gray-50 transition">
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                  <span *ngIf="i === 0 && stat.received_count > 0" class="text-2xl">ğŸ¥‡</span>
                  <span *ngIf="i === 1 && stat.received_count > 0" class="text-2xl">ğŸ¥ˆ</span>
                  <span *ngIf="i === 2 && stat.received_count > 0" class="text-2xl">ğŸ¥‰</span>
                  <span *ngIf="i > 2 || stat.received_count === 0">{{ i + 1 }}</span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <div class="flex items-center">
                    <div class="w-10 h-10 bg-gradient-to-br from-primary-200 to-primary-300 rounded-full flex items-center justify-center text-lg mr-3">
                      {{ stat.user_name.charAt(0).toUpperCase() }}
                    </div>
                    <div class="text-sm font-medium text-gray-900">
                      {{ stat.user_name }}
                    </div>
                  </div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-center">
                  <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium"
                        [class.bg-green-100]="stat.given_count > 0"
                        [class.text-green-800]="stat.given_count > 0"
                        [class.bg-gray-100]="stat.given_count === 0"
                        [class.text-gray-800]="stat.given_count === 0">
                    {{ stat.given_count }}
                  </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-center">
                  <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium"
                        [class.bg-blue-100]="stat.received_count > 0"
                        [class.text-blue-800]="stat.received_count > 0"
                        [class.bg-gray-100]="stat.received_count === 0"
                        [class.text-gray-800]="stat.received_count === 0">
                    {{ stat.received_count }}
                  </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-center text-sm">
                  <span [class]="getUserStatus(stat).class">
                    {{ getUserStatus(stat).icon }} {{ getUserStatus(stat).text }}
                  </span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Legende -->
      <div class="mt-6 card bg-blue-50">
        <h3 class="font-semibold text-blue-900 mb-3">ğŸ“Œ Legende</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-blue-800">
          <div><span class="font-medium">ğŸŒŸ Alle Ziele erfÃ¼llt:</span> Gegeben â‰¥1 & Erhalten â‰¥1</div>
          <div><span class="font-medium">âœ… Ziel erreicht:</span> Erhalten â‰¥1 High-Five</div>
          <div><span class="font-medium">ğŸ‘‹ Hat gegeben:</span> Gegeben â‰¥1 High-Five</div>
          <div><span class="font-medium">âš ï¸ BenÃ¶tigt Aufmerksamkeit:</span> Noch keine High-Fives</div>
        </div>
        <p class="mt-3 text-sm text-blue-700">
          <strong>Wochenziel:</strong> Jeder muss mindestens 1 High-Five pro Woche erhalten!
        </p>
      </div>
    </div>
  </main>
</div>
